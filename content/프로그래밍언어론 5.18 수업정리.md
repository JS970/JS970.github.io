+++
title = "프로그래밍언어론 2023-05-18 수업정리"
date = 2023-05-18
[taxonomies]
tags = ["Programming Language Principles"]
[extra]
author = "JS970"
katex= true
+++
# Flow
- Table
- Size
- Modulo
- Functions
- Lambda
- Local Function

## Table
---
### Table in Lua
- Lua의 Table은 연관 배열(Associative Array)이다.
- 테이블 원소에 필드 이름을 붙이면 레코드처럼 사용할 수 있다.
	- 참조할 때는 필드 이름을 `문자열`로 참조한다.
		```Lua
		pnt = {x=3, y=4}
		print(pnt["x"] + pnt["y"])
		```
- Mixed Table형태로 레코드와 배열을 한 테이블에 사용 가능하다.
	- 이때 레코드와 배열의 구분을 위해 `;`을 사용한다.
		```Lua
		fav = {name="Lua", year=1993; "script", "dynamic", "fast"}
		```
- Generic for구문에서 pairs함수를 이용하여 테이블의 key를 참조한다.
	```Lua
	for k in pairs(fav) do
		print(k)
	end
	```
	- pairs함수는 테이블의 key, value값을 반환하는 반복자다.
	- 이때 k만 사용했기 때문에 value부분은 자동으로 무시된 것이다.
- Numeric for구문과 ipairs함수를 을 활용하여 Table의 배열을 표현할 수 있다.
	```Lua
	for i, v in ipairs(fav) do
		print(i, v)
	end
	```
	- ipairs 함수는 테이블의 index, value값을 반환하는 반복자다.

## Measuring Size
---
### Sharp(#)
- Sharp(#) 기호를 사용하여 크기를 측정할 수 있다. 아래 프로그램은 5를 출력한다.
	```Lua
	print(#"HEllo")
	```
- Sharp(#) 기호는 테이블에서 리스트 부분의 크기만을 반환한다. 아래 프로그램은 3을 출력한다.
	```Lua
	fav = {name="Lua", year=1993; "script", "dynamic", "fast"}
	print(#fav)
	```

## Modular Operation
---
- 원래 Lua에는 나머지 연산자가 없었다.
	- 현재(2023-05-18) 시점에서 Lua의 최신 버전은 `%`연산자를 지원한다.
- 따라서 나머지를 구하는 modular연산을 위해 아래와 같은 두 가지 방법을 사용했다.
	- Using math Library
	- Using Formula

### Using math Library
```Lua
math.fmod(17, 5)
```
- 위와 같이 math라이브러리의 fmod함수를 사용해서 나머지를 구할 수 있다.
- 이러한 방식의 경우 음수에 대한 나머지 연산의 결과가 음수가 나올 수 있다. 아래 프로그램은 -2를 출력한다.
	```Lua
	print(math.fmod(-17, 5))
	```

### Using a Formula
- 몫과 나머지 사이의 관게를 통해 나머지 연산을 구하는 방법이다.
- Lua에서 `/`연산은 실수를 반환하므로 math라이브러리의 floor함수를 사용하여 정수로 변환해야 한다.
- 이러한 방식의 경우 음수에 대한 나머지 연산의 결과가 음수가 나올 수 없다. 아래 프로그램은 3을 출력한다.
	```Lua
	print(17-math.floor(17/5)*5)
	```

## Comments
---
- 두 개의 `-`를 쓰면 그 행 끝까지 주석이다.
	```Lua
	-- This is a comment.
	```
- `[[]]`는 여러 줄을 표현하는 표현이다. Python에서의 `"""`와 같은 표현이다. 이를 활용하여 multiline에 대한 comment가 가능하다.
	```Lua
	--[[This is a 
		multiline comment.]]
	```
	- 당연하지만 이런 식의 표현은 출력문 등 다른 함수에서도 사용 가능하다.
		```Lua
		print([[Hello
				World!]])
		```
	- long string literal로 사용되었을 경우 개행까지 반영되므로 주의하자.

## Functions
---
- 함수 정의 키워드 `function`을 이용한다.
- 대입과 마찬가지로 인수 전달 과정에서 모자라는 인수는 `nil`, 남는 인수는 무시한다.
- 함수 정의 예시
	```Lua
	function add(a, b)
		return a + b
	end
	```

### Default Argument
- Lua에서는 default argument를 지원하지 않는다.
- 하지만 조건 연산자를 이용하여 함수의 default argument를 구현할 수 있다.
- 인수가 `nil`이면 원하는 default argument로 설정하도록 처리하면 된다.
- 기본 인수를 사용한 함수 정의 예시
	```Lua
	function add(a, b)
		b = b or 0
		a = a or 0
		return a + b
	end
	```

### Nested Functions
- 함수 내에 함수를 정의할 수 있다.
- 이때 함수 내부에 정의된 함수도 전역 함수임에 유의하자.
- 아래는 중첩 함수 선언 예시이다.
	```Lua
	function add(a, b)
		function add1(b)
			return b + 1
		end
		return a == 0 and b or add(a-1, add1(b))
	end
	```
	- add1함수는 add함수 외부 영역에서도 사용 가능하다.

## Lambda
---
- 람다 함수란 이름 없는 함수를 뜻한다.
- 키워드 function다음에 아무 이름 없이 함수를 쓰면 람다 함수가 된다.
- 아래 프로그램을 실행시키면 5가 출력된다.
	```Lua
	print((function(a, b) return a+b end)(2, 3))
	```

### Local Function
- 변수와 마찬가지로 Lua의 모든 함수는 기본적으로 global이다.
- 람다 함수를 사용하여 함수를 지역 함수로 정의할 수 있다.
- 지역 함수 정의 예시
	```Lua
	function add(a, b)
		local add1 = function(b)
			return b+1
		end
		return a == 0 and b or add(a-1, add1(b))
	end
	```
- 지역 함수 사용 시 지역 함수가 재귀 함수라면 위의 프로그램과 같이 사용할 경우 오류이다.
- 이때는 지역 변수를 먼저 선언하여 사용해야 한다. 아래는 올바른 지역 재귀 함수 사용 예시이다.
	```Lua
	function count(n)
		local down
		down = function(n)
			if n == 0 then
				print("Beep!")
			else
				print(n)
				down(n-1)
			end
		end
		down(n)
	end
	```

