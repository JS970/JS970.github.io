<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
<title>Special IP &amp; NAT | Rounding Off</title>



<meta property="og:title" content="Special IP &amp; NAT">



<meta name="author" content="JS970">


<meta property="og:locale" content="en-US">


<meta name="description" content="writing is much easier than remembering">
<meta property="og:description" content="writing is much easier than remembering">



<link rel="canonical" href="https://js970.github.io/special-ip-nat/">
<meta property="og:url" content="https://js970.github.io/special-ip-nat/">



<meta property="og:site_name" content="Rounding Off" />





  <meta property="og:type" content="article" />
  <meta property="article:published_time" content="2022-10-20T00:00:00+00:00">







  <meta name="twitter:card" content="summary">



  <meta property="twitter:title" content="Special IP &amp; NAT">








<script type="application/ld+json">
{
  "author": {
    "@type":"Person",
	  "name":"JS970",
  },
  "description": "writing is much easier than remembering",
  "url": "https://js970.github.io/special-ip-nat/",
  "@context":"https://schema.org",
  "@type": "BlogPosting",
  "headline": "Special IP &amp; NAT"
  
    
    
      "datePublished":"2022-10-20T00:00:00+00:00",
    
    "mainEntityOfPage":{
      "@type":"WebPage",
      "@id":"https://js970.github.io/special-ip-nat/"
    },
  
}
</script>

  <link rel="stylesheet" href="https://js970.github.io/main.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Libre+Baskerville:400,400i,700">

  <link rel="icon" type="image/png" sizes="32x32" href="https://js970.github.io/assets/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="https://js970.github.io/assets/favicon-16x16.png">
  <link rel="apple-touch-icon" sizes="180x180" href="https://js970.github.io/assets/apple-touch-icon.png">

  
    <link type="application/atom+xml" rel="alternate" href="https://js970.github.io/atom.xml" title="Rounding Off" />
  

  

  
  
</head>

<body>
  
  <nav class="nav">
    <div class="nav-container">
      <a href="https://js970.github.io/">
        <h2 class="nav-title">Rounding Off</h2>
      </a>
      <ul>
        
          
            <li><a href="https://js970.github.io">Posts</a></li>
          
            <li><a href="https://js970.github.io/tags">Tags</a></li>
          
            <li><a href="https://js970.github.io/about">About</a></li>
          
        
      </ul>
    </div>
  </nav>
  

  <main>
    
  <div class="post">
  	<div class="post-info">
  		<span>Written by</span> JS970<br>
  		
  		<span>on&nbsp;</span><time datetime="2022-10-20">October 20, 2022</time>
  	</div>
  	<h1 class="post-title">Special IP &amp; NAT</h1>
  	<div class="post-line"></div>
  	<h2 id="4-special-ip-address">4 special IP address</h2>
<ul>
<li>Multicast IP address → class D</li>
<li>Broadcast IP address
<ul>
<li>255.255.255.255(broadcast on LAN)</li>
<li>164.125.255.255(broadcast on distance network)</li>
</ul>
</li>
</ul>
<aside>
⚠️ **broadcast 는 L2 broadcast와 L3 broadcast가 있다**
- L2 broadcast : destination MAC address가 ff:ff:ff:ff:ff:ff
→ 로컬 네트워크의 모든 노드에게 이 프레임을 전송한다. 스위치는 이 프레임을 보는 즉시 모든 인터페이스를 통해 이 프레임을 흘려보낸다.(flood)
- L3 broadcast : destination IP address가 특별한 값을 가진다.
→ 255.255.255.255의 IP주소를 목적지 IP주소로 설정한다면 LAN의 라우터를 포함한 모든 노드로 패킷을 전송한다. 또한, 이 경우에는 dst MAC address가 ff:ff:ff:ff:ff:ff임을 확인할 수 있다. 이는 L2 broadcast가 동시에 진행됨을 의미한다.
</aside>
<aside>
⚠️ **direct broadcast**
10.11.22.0/24 네트워크에서 direct broadcast를 위한 IP 주소는 10.11.22.255이다.
이 주소로 broadcast를 시도하면 위의 255.255.255.255(local broadcast)와 같은 동작을 한다.
마찬가지로 이 경우에도 destination MAC은 ff:ff:ff:ff:ff:ff이다. 
하지만 위의 경우와 다르게, 이렇게 direct broadcast를 시도하면 와이어샤크 등 패킷 캡쳐 프로그램은 이를 broadcast로 인식하지 못한다.(/24 mask가 있는 네트워크인지 알 방법이 없으므로)
같은 역할을 하는 것 처럼 보이지만, direct broadcast를 사용할 경우 local뿐만이 아닌 broadcast on distance network가 가능하다.
direct broadcast를 이용한 distance network로의 broadcast는 해당 네트워크의 netmask를 아는 라우터를 제외하고는 unicast로 인식되어 패킷이 전송된다. broadcast할 네트워크에서 netmask를 통해 broadcast되기 전까지는 unicast규칙을 따른다.
</aside>
<p><a href="https://www.practicalnetworking.net/stand-alone/local-broadcast-vs-directed-broadcast/">Local Broadcast vs Directed Broadcast - Practical Networking .net</a></p>
<ul>
<li>Loopback IP address
<ul>
<li>destination IP address : 127.0.0.1</li>
<li>destination IP address가 위와 같은 주소를 가진다면 loopback IP address이다.</li>
<li>네트워크 계층에서는 데이터링크 계층 및 물리 계층으로 해당 패킷을 내려보내지 않고, 마치 자신이 다시 수신한 것 처럼 상위 계층(전송 계층, L4)으로 올려보낸다.</li>
<li>서버/클라이언트 프로그램이 네트워크에 연결되지 않은 상태에서 디버깅하는 용도로 사용된다.</li>
<li>시스템 자신을 의미하는 표현으로 내부적으로만 사용된다.</li>
</ul>
</li>
<li>Private/Public IP address
<ul>
<li>
<p>private IP :</p>
<ul>
<li>10.XX.YY.ZZ - class A</li>
<li>192.168.XX.YY - class B</li>
</ul>
</li>
<li>
<p>public IP :</p>
<ul>
<li>모두에게 열려 있다.</li>
<li>동일한 IP주소가 존재할 수 없다.</li>
</ul>
</li>
<li>
<p>일반 사용자의 경우 하나의 public IP를 ISP(Internet Service Provider)로부터 구매한다.</p>
</li>
<li>
<p>public IP를 이용해 subnet을 구축하고, DHCP를 이용하여 private IP를 분배한다.</p>
<p>⇒ 라우터는 private IP로는 절대 포워딩하지 않는다.</p>
<p>⇒ 그렇다면 어떻게 private IP에 연결된 device에서 인터넷을 이용할 수 있는 것인가??</p>
<p>⇒ NAT(Network Address Translation)을 이용하여 가능하다.</p>
</li>
</ul>
</li>
</ul>
<h2 id="nat-network-address-translation">NAT(Network Address Translation)</h2>
<p><img src="/image/Special_IP&amp;NAT/Untitled.png" alt="Untitled" /></p>
<ul>
<li>ipv4는 $2^{32}$개의 주소 할당이 가능하다.</li>
<li>하지만 IoT의 시대로 접어들면서 이는 사실상 불가능해졌다.</li>
<li>이를 해결하기 위해 IPv6가 나왔으나 모든 기기에서 ipv4를 ipv6로 한번에 교체하는 것 역시 불가능하다.</li>
<li>이를 위해 NAT을 사용한다.</li>
<li>NAT를 사용하여 다수의 private IP address를 하나의 public IP address로 변환하는 것이 가능.</li>
<li>내부망을 사용하는 PC에는 사설 IP를 부여하고, 외부망을 사용할 경우 하나의 public IP를 사용하는 형태로 운영 가능하다.</li>
<li>NAT은 IP address 와 Port로 구성된 NAT forwarding table을 이용하여 이에 맞게 주소 변환 서비스를 제공한다.</li>
<li>동작 과정은 아래와 같다.
<ol>
<li>outgoing packet이 NAT box를 거칠 때, packet의 original source ip address는 public ip address로 교체된다.</li>
<li>TCP port는 65,536($2^{16}$)개의 NAT index로 replace된다. 이 과정은 서로 다른 호스트가 같은 포트를 사용할 수 있기 때문에 필수적이다. 이때 NAT index로 mapping되는 original ip address, original source port를 NAT테이블에 저장한다.</li>
<li>ip, TCP header의 checksum을 다시 계산한다.</li>
<li>ISP로부터의 packet이 NAT box로 돌아오면 헤더의 port를 읽어서 NAT box의 mapping table의 index로 사용한다.</li>
<li>NAT box의 index를 통해 찾은 original IP address, original port number로 packet을 변경한다.</li>
<li>ip, TCP header의 checksum을 다시 계산한다.</li>
<li>라우터를 통해 실제 서비스 요청 노드로 packet을 전송한다.</li>
</ol>
</li>
</ul>
<p><img src="/image/Special_IP&amp;NAT/Untitled%201.png" alt="Untitled" /></p>
<h3 id="nat-ddajjeo">NAT 단점</h3>
<ul>
<li>
<p>IP 는 connectionless한 특성을 가지지만 NAT는 connection oriented이다.</p>
<p>→ 복잡성을 증가시킨다.</p>
</li>
<li>
<p>PORT를 사용하므로 TCP &amp; UDP만 사용 가능하다.</p>
</li>
<li>
<p>Maximum connection의 개수가 65535개로 제한된다(16 bits)</p>
</li>
<li>
<p>성능 감소(레이턴시)</p>
</li>
</ul>

  </div>

	

  <div class="pagination">
  	
		<a href="#" class="top">Top</a>
		
  </div>

  </main>

  
  <footer>
    <span>&copy; 2022 JS970. Made with <a href="https://www.getzola.org">Zola</a> using the <a
          href="https://github.com/aaranxu/tale-zola">Tale-Zola</a> theme.</span>
  </footer>
  
</body>
</html>
